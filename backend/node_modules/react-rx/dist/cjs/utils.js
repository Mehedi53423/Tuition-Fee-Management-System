"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.observeElement = exports.observeContext = exports.observeCallback = exports.observeState = void 0;
var useAsObservable_1 = require("./useAsObservable");
var observable_callback_1 = require("observable-callback");
var operators_1 = require("rxjs/operators");
var react_1 = require("react");
var createState = function (initialState) { return (0, observable_callback_1.observableCallback)((0, operators_1.startWith)(initialState)); };
function observeState(initial) {
    var _a = (0, react_1.useState)(initial), value = _a[0], update = _a[1];
    return [(0, useAsObservable_1.useAsObservable)(value), update];
}
exports.observeState = observeState;
function observeCallback(operator) {
    var ref = (0, react_1.useRef)();
    if (!ref.current) {
        ref.current = operator ? (0, observable_callback_1.observableCallback)(operator) : (0, observable_callback_1.observableCallback)();
    }
    return ref.current;
}
exports.observeCallback = observeCallback;
function observeContext(context) {
    return (0, useAsObservable_1.useAsObservable)((0, react_1.useContext)(context));
}
exports.observeContext = observeContext;
function observeElement() {
    var ref = (0, react_1.useRef)();
    if (!ref.current) {
        ref.current = createState(null);
    }
    return ref.current;
}
exports.observeElement = observeElement;
