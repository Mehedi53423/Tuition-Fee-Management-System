"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useObservableCallback = void 0;
var react_1 = require("react");
var observable_callback_1 = require("observable-callback");
var EMPTY_DEPS = [];
function useObservableCallback(fn, dependencies) {
    if (dependencies === void 0) { dependencies = EMPTY_DEPS; }
    var callbackRef = (0, react_1.useRef)();
    if (!callbackRef.current) {
        callbackRef.current = (0, observable_callback_1.observableCallback)();
    }
    var _a = callbackRef.current, calls$ = _a[0], call = _a[1];
    // eslint-disable-next-line react-hooks/exhaustive-deps
    var callback = (0, react_1.useCallback)(fn, dependencies);
    (0, react_1.useEffect)(function () {
        var subscription = calls$.pipe(callback).subscribe();
        return function () {
            subscription.unsubscribe();
        };
    }, [calls$, call, callback]);
    return call;
}
exports.useObservableCallback = useObservableCallback;
