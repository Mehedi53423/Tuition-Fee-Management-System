{"version":3,"sources":["../../src/middleware/jsonResponse.js"],"names":["objectAssign","require","module","exports","opts","onResponse","response","contentType","headers","shouldDecode","force","indexOf","body","tryParse","processOptions","options","Accept","JSON","parse","err","message"],"mappings":";;AAAA,MAAMA,YAAY,GAAGC,OAAO,CAAC,eAAD,CAA5B;;AAEAC,MAAM,CAACC,OAAP,GAAiBC,IAAI,KAAK;AACxBC,EAAAA,UAAU,EAAEC,QAAQ,IAAI;AACtB,UAAMC,WAAW,GAAGD,QAAQ,CAACE,OAAT,CAAiB,cAAjB,KAAoC,EAAxD;AACA,UAAMC,YAAY,GAAIL,IAAI,IAAIA,IAAI,CAACM,KAAd,IAAwBH,WAAW,CAACI,OAAZ,CAAoB,kBAApB,MAA4C,CAAC,CAA1F;;AACA,QAAI,CAACL,QAAQ,CAACM,IAAV,IAAkB,CAACL,WAAnB,IAAkC,CAACE,YAAvC,EAAqD;AACnD,aAAOH,QAAP;AACD;;AAED,WAAON,YAAY,CAAC,EAAD,EAAKM,QAAL,EAAe;AAACM,MAAAA,IAAI,EAAEC,QAAQ,CAACP,QAAQ,CAACM,IAAV;AAAf,KAAf,CAAnB;AACD,GATuB;AAWxBE,EAAAA,cAAc,EAAEC,OAAO,IACrBf,YAAY,CAAC,EAAD,EAAKe,OAAL,EAAc;AACxBP,IAAAA,OAAO,EAAER,YAAY,CAAC;AAACgB,MAAAA,MAAM,EAAE;AAAT,KAAD,EAA+BD,OAAO,CAACP,OAAvC;AADG,GAAd;AAZU,CAAL,CAArB;;AAiBA,SAASK,QAAT,CAAkBD,IAAlB,EAAwB;AACtB,MAAI;AACF,WAAOK,IAAI,CAACC,KAAL,CAAWN,IAAX,CAAP;AACD,GAFD,CAEE,OAAOO,GAAP,EAAY;AACZA,IAAAA,GAAG,CAACC,OAAJ,GAAe,2CAA0CD,GAAG,CAACC,OAAQ,EAArE;AACA,UAAMD,GAAN;AACD;AACF","sourcesContent":["const objectAssign = require('object-assign')\n\nmodule.exports = opts => ({\n  onResponse: response => {\n    const contentType = response.headers['content-type'] || ''\n    const shouldDecode = (opts && opts.force) || contentType.indexOf('application/json') !== -1\n    if (!response.body || !contentType || !shouldDecode) {\n      return response\n    }\n\n    return objectAssign({}, response, {body: tryParse(response.body)})\n  },\n\n  processOptions: options =>\n    objectAssign({}, options, {\n      headers: objectAssign({Accept: 'application/json'}, options.headers)\n    })\n})\n\nfunction tryParse(body) {\n  try {\n    return JSON.parse(body)\n  } catch (err) {\n    err.message = `Failed to parsed response body as JSON: ${err.message}`\n    throw err\n  }\n}\n"],"file":"jsonResponse.js"}