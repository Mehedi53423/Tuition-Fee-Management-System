{"version":3,"sources":["../../src/middleware/observable.js"],"names":["global","require","objectAssign","module","exports","opts","Observable","implementation","Error","onReturn","channels","context","observer","error","subscribe","err","progress","event","next","type","response","complete","request","publish","abort"],"mappings":";;AAAA,IAAMA,MAAM,GAAGC,OAAO,CAAC,gBAAD,CAAtB;;AACA,IAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AAEAE,MAAM,CAACC,OAAP,GAAiB,YAAe;AAAA,MAAdC,IAAc,uEAAP,EAAO;AAC9B,MAAMC,UAAU,GAAGD,IAAI,CAACE,cAAL,IAAuBP,MAAM,CAACM,UAAjD;;AACA,MAAI,CAACA,UAAL,EAAiB;AACf,UAAM,IAAIE,KAAJ,CACJ,iFADI,CAAN;AAGD;;AAED,SAAO;AACLC,IAAAA,QAAQ,EAAE,kBAACC,QAAD,EAAWC,OAAX;AAAA,aACR,IAAIL,UAAJ,CAAe,UAAAM,QAAQ,EAAI;AACzBF,QAAAA,QAAQ,CAACG,KAAT,CAAeC,SAAf,CAAyB,UAAAC,GAAG;AAAA,iBAAIH,QAAQ,CAACC,KAAT,CAAeE,GAAf,CAAJ;AAAA,SAA5B;AACAL,QAAAA,QAAQ,CAACM,QAAT,CAAkBF,SAAlB,CAA4B,UAAAG,KAAK;AAAA,iBAAIL,QAAQ,CAACM,IAAT,CAAchB,YAAY,CAAC;AAACiB,YAAAA,IAAI,EAAE;AAAP,WAAD,EAAqBF,KAArB,CAA1B,CAAJ;AAAA,SAAjC;AACAP,QAAAA,QAAQ,CAACU,QAAT,CAAkBN,SAAlB,CAA4B,UAAAM,QAAQ,EAAI;AACtCR,UAAAA,QAAQ,CAACM,IAAT,CAAchB,YAAY,CAAC;AAACiB,YAAAA,IAAI,EAAE;AAAP,WAAD,EAAqBC,QAArB,CAA1B;AACAR,UAAAA,QAAQ,CAACS,QAAT;AACD,SAHD;AAKAX,QAAAA,QAAQ,CAACY,OAAT,CAAiBC,OAAjB,CAAyBZ,OAAzB;AACA,eAAO;AAAA,iBAAMD,QAAQ,CAACc,KAAT,CAAeD,OAAf,EAAN;AAAA,SAAP;AACD,OAVD,CADQ;AAAA;AADL,GAAP;AAcD,CAtBD","sourcesContent":["const global = require('../util/global')\nconst objectAssign = require('object-assign')\n\nmodule.exports = (opts = {}) => {\n  const Observable = opts.implementation || global.Observable\n  if (!Observable) {\n    throw new Error(\n      '`Observable` is not available in global scope, and no implementation was passed'\n    )\n  }\n\n  return {\n    onReturn: (channels, context) =>\n      new Observable(observer => {\n        channels.error.subscribe(err => observer.error(err))\n        channels.progress.subscribe(event => observer.next(objectAssign({type: 'progress'}, event)))\n        channels.response.subscribe(response => {\n          observer.next(objectAssign({type: 'response'}, response))\n          observer.complete()\n        })\n\n        channels.request.publish(context)\n        return () => channels.abort.publish()\n      })\n  }\n}\n"],"file":"observable.js"}