"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function i(t,e,o){return(i=n()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function o(t){var n="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,o)}function o(){return i(t,arguments,e(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),r(o,t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0});var s=Object.freeze({left:0,top:0,bottom:0,right:0}),a=Object.freeze({x:.5,y:.5,height:1,width:1}),u=function(){return t({},s)},f=function(){return t({},a)},p=function(t){var e,r;function n(e,r){var n;return void 0===r&&(r="Failed to resolve asset ID from source"),(n=t.call(this,r)||this).unresolvable=!0,n.input=e,n}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n}(o(Error));function l(t){return Boolean(t.unresolvable&&"input"in t)}function c(t){return function(){try{return t.apply(void 0,arguments)}catch(t){if(l(t))return;throw t}}}var d="https://cdn.sanity.io",h=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+\.[a-z0-9]+$/,x=/^file-[a-zA-Z0-9_]+-[a-z0-9]+$/,g=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})-\d+x\d+\.[a-z0-9]+$/,m=/^image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+$/,y=/^(images|files)\/([a-z0-9]+)\/([a-z0-9][-\w]*)\//,v=/^(?:image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+|file-[a-zA-Z0-9_]+-[a-z0-9]+)$/,w={projectId:"a",dataset:"b"};function I(t){return O(t)&&"string"==typeof t._ref}function b(t){return O(t)&&"string"==typeof t._id}function A(t){return O(t)&&"string"==typeof t.path}function F(t){return O(t)&&"string"==typeof t.url}function _(t){return O(t)&&"sanity.fileAsset"===t._type}function j(t){return O(t)&&"sanity.imageAsset"===t._type}function U(t){var e=t;return O(e)&&e.asset&&"object"==typeof e.asset}function O(t){return null!==t&&!Array.isArray(t)&&"object"==typeof t}function S(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for image");var i="metadata"in t?t.metadata.dimensions:{width:t.width,height:t.height};return"images/"+r+"/"+n+"/"+t.assetId+"-"+i.width+"x"+i.height+"."+t.extension+Z("originalFilename"in t?t.originalFilename:void 0,t.vanityFilename,e)}function z(t,e){return d+"/"+S(t,e)}function E(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for file");return"files/"+r+"/"+n+"/"+t.assetId+"."+t.extension+Z("originalFilename"in t?t.originalFilename:void 0,t.vanityFilename,e)}function P(t,e){return d+"/"+E(t,e)}function R(t){return U(t)?R(t.asset):I(t)?void 0:"string"==typeof t?y.test(G(t)||"")?D(t):void 0:A(t)?t.path:F(t)?D(t.url):void 0}function D(t){if(y.test(t))return t;if(!t.startsWith(d+"/"))throw new p('Failed to resolve path from URL "'+t+'"');var e=t.indexOf("?");return t.slice(d.length+1,-1===e?void 0:e)}var G=c(D);function L(t){var e=(G(t)||t).replace(/^(images|files)\/[a-z0-9]+\/[a-z0-9][-\w]\/*/,"");if(!T(e))throw new p('Failed to resolve filename from URL "'+t+'"');return e}var $=c(L);function T(t){return h.test(t)||g.test(t)}function Z(t,e,r){var n=e||t;return!1!==(null==r?void 0:r.useVanityName)&&n?"/"+n:""}function M(t){if(m.test(t))return V(t);if(x.test(t))return N(t);throw new Error("Invalid image/file asset ID: "+t)}function N(t){if(!x.test(t))throw new Error("Malformed file asset ID '"+t+'\'. Expected an id like "file-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-pdf"');var e=t.split("-");return{type:"file",assetId:e[1],extension:e[2]}}function V(t){var e=t.split("-"),r=e[1],n=e[2],i=e[3],o=(n||"").split("x").map(Number),s=o[0],a=o[1];if(!(r&&n&&i&&s>0&&a>0))throw new Error("Malformed asset ID '"+t+'\'. Expected an id like "image-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-2000x3000-jpg".');return{type:"image",assetId:r,width:s,height:a,extension:i}}function W(t){var e=$(t)||"";if(!T(e))throw new Error("Invalid image/file asset filename: "+t);try{return M((g.test(e)?"image":"file")+"-"+e.replace(/\.([a-z0-9+]+)$/i,"-$1"))}catch(e){throw new Error("Invalid image/file asset filename: "+t)}}function C(e){if(!e.startsWith(d))throw new Error("URL is not a valid Sanity asset URL: "+e);var r=e.slice(d.length).replace(/^\/+/,""),n=r.match(y)||[],i=n[0],o=n[2],s=n[3];if(!o||!s)throw new Error("URL is not a valid Sanity asset URL: "+e);var a=r.slice(i.length).split("/"),u=a[1];return t({},W(a[0]),{projectId:o,dataset:s,vanityFilename:u})}function H(t){try{return C(t).type}catch(t){return!1}}function k(t){var e=V(it(t)),r=e.width,n=e.height;return{width:r,height:n,aspectRatio:r/n}}var q=c(k);function B(t){return dt(t)?tt(t,w).asset.extension:K(t,w).asset.extension}var J=c(B);function K(t,e){var r=t;return{asset:X(t,e||pt(t)),crop:r.crop||u(),hotspot:r.hotspot||f()}}var Q=c(K);function X(e,r){var n=t({},r||ft(e),{useVanityName:!1}),i=it(e),o=(e.asset||e).metadata||{},s=V(i),a=s.assetId,u=s.width,f=s.height,p=s.extension,l=u/f,c=t({},j(e)?e:{},{_id:i,_type:"sanity.imageAsset",assetId:a,extension:p,metadata:t({},o,{dimensions:{width:u,height:f,aspectRatio:l}}),url:"",path:""});return t({},c,{path:S(c,n),url:z(c,n)})}var Y=c(X);function tt(t,e){return{asset:rt(t,e||pt(t))}}var et=c(tt);function rt(e,r){var n=t({},r||ft(e),{useVanityName:!1}),i=it(e),o=e.asset||e,s=N(i),a=s.assetId,u=s.extension,f=t({},_(e)?e:{},{_id:i,_type:"sanity.fileAsset",assetId:a,extension:u,metadata:o.metadata||{},url:"",path:""});return t({},f,{path:E(f,n),url:P(f,n)})}var nt=c(rt);function it(t){var e=U(t)?t.asset:t,r="";if("string"==typeof e?r=st(e):I(e)?r=e._ref:b(e)?r=e._id:A(e)?r=ut(d+"/"+e.path):F(e)&&(r=ut(e.url)),!r||!v.test(r))throw new p(t);return r}var ot=c(it);function st(t){if(v.test(t))return t;if(0===t.indexOf(d+"/images")||0===t.indexOf(d+"/files"))return ut(t);if(y.test(t))return ut(d+"/"+t);if(ct(t))return ut(d+"/files/a/b/"+t);if(lt(t))return ut(d+"/images/a/b/"+t);throw new p(t)}var at=c(st);function ut(t){var e=D(t).split("/"),r=e[3];return e[0].replace(/s$/,"")+"-"+r.replace(/\./g,"-")}function ft(t){var e=R(t);if(!e)throw new p(t,"Failed to resolve project ID and dataset from source");var r=e.match(y)||[],n=r[2],i=r[3];if(!n||!i)throw new p(t,"Failed to resolve project ID and dataset from source");return{projectId:n,dataset:i}}var pt=c(ft);function lt(t){return g.test(t)}function ct(t){return h.test(t)}function dt(t){return it(t).startsWith("file-")}exports.DEFAULT_CROP=s,exports.DEFAULT_HOTSPOT=a,exports.buildFilePath=E,exports.buildFileUrl=P,exports.buildImagePath=S,exports.buildImageUrl=z,exports.getAssetDocumentId=it,exports.getAssetUrlType=H,exports.getDefaultCrop=u,exports.getDefaultHotspot=f,exports.getExtension=B,exports.getFile=tt,exports.getFileAsset=rt,exports.getIdFromString=st,exports.getImage=K,exports.getImageAsset=X,exports.getImageDimensions=k,exports.getProject=ft,exports.getUrlFilename=L,exports.getUrlPath=D,exports.isAssetFilename=function(t){return lt(t)||ct(t)},exports.isAssetIdStub=b,exports.isAssetObjectStub=U,exports.isAssetPathStub=A,exports.isAssetUrlStub=F,exports.isDefaultCrop=function(t){return t.top===s.top&&t.bottom===s.bottom&&t.left===s.left&&t.right===s.right},exports.isDefaultHotspot=function(t){return t.x===a.x&&t.y===a.y&&t.width===a.width&&t.height===a.height},exports.isFileAssetFilename=ct,exports.isFileSource=dt,exports.isImageAssetFilename=lt,exports.isImageSource=function(t){return it(t).startsWith("image-")},exports.isObject=O,exports.isReference=I,exports.isSanityAssetUrl=function(t){return!1!==H(t)},exports.isSanityFileAsset=_,exports.isSanityFileUrl=function(t){return"file"===H(t)},exports.isSanityImageAsset=j,exports.isSanityImageUrl=function(t){return"image"===H(t)},exports.isValidFilename=T,exports.parseAssetFilename=W,exports.parseAssetId=M,exports.parseAssetUrl=C,exports.parseFileAssetId=N,exports.parseFileAssetUrl=function(t){var e=C(t);if("file"!==e.type)throw new Error("URL is not a valid Sanity file asset URL: "+t);return e},exports.parseImageAssetId=V,exports.parseImageAssetUrl=function(t){var e=C(t);if("image"!==e.type)throw new Error("URL is not a valid Sanity image asset URL: "+t);return e},exports.tryGetAssetDocumentId=ot,exports.tryGetAssetPath=R,exports.tryGetExtension=J,exports.tryGetFile=et,exports.tryGetFileAsset=nt,exports.tryGetIdFromString=at,exports.tryGetImage=Q,exports.tryGetImageAsset=Y,exports.tryGetImageDimensions=q,exports.tryGetProject=pt,exports.tryGetUrlFilename=$,exports.tryGetUrlPath=G;
//# sourceMappingURL=asset-utils.cjs.production.min.js.map
